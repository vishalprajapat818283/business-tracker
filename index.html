<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Business Tracker - Full Inventory Link</title>
  <style>
    body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #f5f7fb;
    display: flex;
    flex-direction: column;
    min-height: 100vh; /* Poori screen ki height cover karega */
}

/* Container ko expand karein taaki wo bachi hui jagah le le */
.container {
    max-width: 1100px;
    margin: 20px auto;
    padding: 0 15px;
    flex: 1; /* Ye main content ko expand karega aur footer ko niche dhakelega */
}
    /* body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f5f7fb; } */
    header { background: #1f2937; color: #fff; padding: 15px 20px; text-align: center; position: relative; }
    /* .container { max-width: 1100px; margin: 20px auto; padding: 0 15px; } */
    .tabs { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
    .tab-btn { border: none; background: #e5e7eb; padding: 8px 14px; border-radius: 4px; cursor: pointer; font-size: 14px; }
    .tab-btn.active { background: #2563eb; color: #fff; }
    section { display: none; background: #fff; border-radius: 6px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.08); margin-bottom: 20px; }
    section.active { display: block; }
    h2 { margin-top: 0; font-size: 18px; color: #111827; border-bottom: 2px solid #f3f4f6; padding-bottom: 10px; margin-bottom: 15px; }
    form { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; margin-bottom: 15px; align-items: end; }
    label { font-size: 11px; color: #374151; display: block; margin-bottom: 3px; font-weight: bold; }
    input { width: 100%; padding: 8px; font-size: 14px; border-radius: 4px; border: 1px solid #d1d5db; box-sizing: border-box; }
    .btn { padding: 8px 12px; border-radius: 4px; border: none; cursor: pointer; font-size: 14px; }
    .btn-primary { background: #2563eb; color: #fff; }
    .btn-danger { background: #dc2626; color: #fff; }
    table { width: 100%; border-collapse: collapse; margin-top: 5px; font-size: 12px; }
    th, td { border: 1px solid #e5e7eb; padding: 10px 8px; text-align: left; }
    th { background: #f3f4f6; color: #374151; }
    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px; }
    .card { background: #fff; border-radius: 8px; padding: 15px; border: 1px solid #e5e7eb; text-align: center; }
    .card-title { font-size: 11px; text-transform: uppercase; color: #6b7280; margin-bottom: 5px; }
    .card-value { font-size: 20px; color: #111827; font-weight: bold; }
    .profit { color: #16a34a; }
    .loss { color: #dc2626; }
    .auth-container { max-width: 400px; margin: 60px auto; background: #fff; padding: 30px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
    .error-msg { color: #dc2626; font-size: 13px; margin-top: 10px; display: none; text-align: center; }
    .highlight-box { background: #fef3c7; padding: 8px; border-radius: 4px; border: 1px solid #fde68a; }


/* Footer styling */
#footer {
    background: #222426; /* Header jaisa dark color */
    color: #ffffff;
    padding: 15px 0;
    text-align: center;
    font-size: 14px;
    margin-top: 30px;
    width: 100%;
}

#footer a {
    color: #60a5fa; /* Light blue link */
    font-weight: bold;
    text-decoration: none;
    margin-left: 5px;
}

#footer a:hover {
    text-decoration: underline;
}
  </style>
</head>
<body>

  <div id="authSection" class="auth-container">
    <h1 style="text-align:center;">ðŸ’¼ Tracker Pro</h1>
    <div id="loginForm">
      <label>Email</label><input type="email" id="lEmail" style="margin-bottom:10px;">
      <label>Password</label><input type="password" id="lPass" style="margin-bottom:15px;">
      <button class="btn btn-primary" style="width:100%" onclick="login()">Login</button>
      <p style="text-align:center; cursor:pointer; color:#2563eb;" onclick="toggleAuth(true)">Create Account</p>
    </div>
    <div id="registerForm" style="display:none;">
      <label>Company</label><input type="text" id="rComp" style="margin-bottom:10px;">
      <label>Email</label><input type="email" id="rEmail" style="margin-bottom:10px;">
      <label>Password</label><input type="password" id="rPass" style="margin-bottom:15px;">
      <button class="btn btn-primary" style="width:100%" onclick="register()">Register</button>
      <p style="text-align:center; cursor:pointer; color:#2563eb;" onclick="toggleAuth(false)">Back to Login</p>
    </div>
    <div id="authError" class="error-msg"></div>
  </div>

  <header id="mainHeader" style="display:none;">
    <h1 id="headerTitle">Company</h1>
    <button class="btn btn-danger" style="position:absolute; right:20px; top:20px;" onclick="logout()">Logout</button>
  </header>

  <div class="container" id="mainApp" style="display:none;">
    <div class="tabs">
      <button class="tab-btn active" data-target="dashboard">Dashboard</button>
      <button class="tab-btn" data-target="rawSection">Raw Material</button>
      <button class="tab-btn" data-target="prodSection">Production</button>
      <button class="tab-btn" data-target="saleSection">Sales</button>
    </div>

    <section id="dashboard" class="active">
      <div class="cards">
        <div class="card"><div class="card-title">Net Profit</div><div class="card-value" id="dProfit">â‚¹0</div></div>
        <div class="card"><div class="card-title">Total Sales</div><div class="card-value" id="dSales">â‚¹0</div></div>
        <div class="card"><div class="card-title">Total Raw Cost</div><div class="card-value" id="dCost">â‚¹0</div></div>
      </div>
      
      <h3>ðŸ“¦ Real-Time Stock Status</h3>
      <table id="stockTable">
        <thead>
          <tr><th>Category</th><th>Item Name</th><th>Total In</th><th>Total Out</th><th>Remains</th></tr>
        </thead>
        <tbody></tbody>
      </table>

      <h3 style="margin-top:20px;">ðŸ“œ All Activity Entries</h3>
      <table id="activityTable">
        <thead>
          <tr><th>Type</th><th>Date</th><th>Item</th><th>Qty</th><th>Details</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="rawSection">
      <h2>Raw Material Collection</h2>
      <form id="fRaw">
        <div><label>Date</label><input type="date" id="riDate" required></div>
        <div><label>Material Name</label><input type="text" id="riName" required></div>
        <div><label>Qty Inward</label><input type="number" id="riQty" step="0.01" required></div>
        <div><label>Total Cost</label><input type="number" id="riCost" step="0.01" required></div>
        <button type="submit" class="btn btn-primary">Save</button>
      </form>
      <table id="tRaw">
        <thead><tr><th>Date</th><th>Material</th><th>Qty</th><th>Cost</th><th>Action</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="prodSection">
      <h2>Production and Raw Usage</h2>
      <form id="fProd">
        <div><label>Date</label><input type="date" id="pDate" required></div>
        <div><label>Product Name</label><input type="text" id="pName" required></div>
        <div><label>Qty Produced</label><input type="number" id="pQty" step="0.01" required></div>
        <div class="highlight-box"><label>Raw Used (Name)</label><input type="text" id="pRawName" required></div>
        <div class="highlight-box"><label>Raw Used (Qty)</label><input type="number" id="pRawQty" step="0.01" required></div>
        <button type="submit" class="btn btn-primary">Save Production</button>
      </form>
      <table id="tProd">
        <thead><tr><th>Date</th><th>Product</th><th>Qty</th><th>Raw Used</th><th>Usage Qty</th><th>Action</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="saleSection">
      <h2>Sales Record</h2>
      <form id="fSale">
        <div><label>Date</label><input type="date" id="sDate" required></div>
        <div><label>Product Name</label><input type="text" id="sName" required></div>
        <div><label>Qty Sold</label><input type="number" id="sQty" step="0.01" required></div>
        <div><label>Sale Amount</label><input type="number" id="sAmt" step="0.01" required></div>
        <button type="submit" class="btn btn-primary">Save Sale</button>
      </form>
      <table id="tSale">
        <thead><tr><th>Date</th><th>Product</th><th>Qty</th><th>Amount</th><th>Action</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>
  </div>

    <div id="footer">
    <div class="text">created by
      <a href="https://www.linkedin.com/in/vishal-prajapati-aa754b3a9">vishal prajapati</a>
    </div>
  </div>

  <script>
// login function
let loggedInEmail = localStorage.getItem('currentSession');
let user = loggedInEmail ? JSON.parse(localStorage.getItem(loggedInEmail)) : null;

// Yeh naya block hai jo check karega ki user pehle se login hai ya nahi
window.addEventListener('load', () => {
    if (user) {
        start();
    }
});

    function toggleAuth(reg) {
      document.getElementById('loginForm').style.display = reg ? 'none' : 'block';
      document.getElementById('registerForm').style.display = reg ? 'block' : 'none';
    }

    function register() {
      const email = document.getElementById('rEmail').value;
      if(localStorage.getItem(email)) return alert("User exists");
      localStorage.setItem(email, JSON.stringify({
        company: rComp.value, email, pass: rPass.value, 
        raw: [], prod: [], sale: [] 
      }));
      alert("Registered!"); toggleAuth(false);
    }

    function login() {
      const data = JSON.parse(localStorage.getItem(lEmail.value));
      if(data && data.pass === lPass.value) {
        user = data;
        localStorage.setItem('currentSession', lEmail.value);
        start(); }
      else alert("Login Failed");
    }

    function start() {
      authSection.style.display='none'; 
      mainHeader.style.display='block';
      mainApp.style.display='block';
      headerTitle.textContent = user.company;
      setTimeout(() => {
        render();
    }, 50);
    }

    function sync() { localStorage.setItem(user.email, JSON.stringify(user)); render(); }

    document.querySelectorAll(".tab-btn").forEach(b => {
      b.onclick = () => {
        document.querySelectorAll(".tab-btn, section").forEach(e => e.classList.remove("active"));
        b.classList.add("active"); document.getElementById(b.dataset.target).classList.add("active");
      }
    });

    // Submissions
    fRaw.onsubmit = (e) => { e.preventDefault(); user.raw.push({id:Date.now(), d:riDate.value, n:riName.value, q:+riQty.value, c:+riCost.value}); e.target.reset(); sync(); };
    fProd.onsubmit = (e) => { e.preventDefault(); user.prod.push({id:Date.now(), d:pDate.value, n:pName.value, q:+pQty.value, rn:pRawName.value, rq:+pRawQty.value}); e.target.reset(); sync(); };
    fSale.onsubmit = (e) => { e.preventDefault(); user.sale.push({id:Date.now(), d:sDate.value, n:sName.value, q:+sQty.value, a:+sAmt.value}); e.target.reset(); sync(); };

    function del(type, id) { user[type] = user[type].filter(i => i.id !== id); sync(); }

    function render() {
      tRaw.querySelector("tbody").innerHTML = user.raw.map(r => `<tr><td>${r.d}</td><td>${r.n}</td><td>${r.q}</td><td>â‚¹${r.c}</td><td><button onclick="del('raw',${r.id})">Del</button></td></tr>`).join('');
      tProd.querySelector("tbody").innerHTML = user.prod.map(p => `<tr><td>${p.d}</td><td>${p.n}</td><td>${p.q}</td><td>${p.rn}</td><td>${p.rq}</td><td><button onclick="del('prod',${p.id})">Del</button></td></tr>`).join('');
      tSale.querySelector("tbody").innerHTML = user.sale.map(s => `<tr><td>${s.d}</td><td>${s.n}</td><td>${s.q}</td><td>â‚¹${s.a}</td><td><button onclick="del('sale',${s.id})">Del</button></td></tr>`).join('');

      // Stock Linking logic
      const inv = {};
      user.raw.forEach(r => { 
        const k = "RAW_"+r.n.toLowerCase(); 
        if(!inv[k]) inv[k] = {c:'Raw', n:r.n, in:0, out:0}; 
        inv[k].in += r.q; 
      });
      user.prod.forEach(p => {
        const rK = "RAW_"+p.rn.toLowerCase();
        if(!inv[rK]) inv[rK] = {c:'Raw', n:p.rn, in:0, out:0};
        inv[rK].out += p.rq; // RAW REDUCES

        const fK = "FIN_"+p.n.toLowerCase();
        if(!inv[fK]) inv[fK] = {c:'Finished', n:p.n, in:0, out:0};
        inv[fK].in += p.q; // PRODUCT INCREASES
      });
      user.sale.forEach(s => {
        const fK = "FIN_"+s.n.toLowerCase();
        if(!inv[fK]) inv[fK] = {c:'Finished', n:s.n, in:0, out:0};
        inv[fK].out += s.q; // PRODUCT REDUCES
      });

      stockTable.querySelector("tbody").innerHTML = Object.values(inv).map(i => `
        <tr><td>${i.c}</td><td>${i.n}</td><td>${i.in}</td><td>${i.out}</td>
        <td style="font-weight:bold; color:${(i.in-i.out)<0?'red':'green'}">${(i.in-i.out).toFixed(2)}</td></tr>
      `).join('');

      // Dashboard Cards
      const cost = user.raw.reduce((a,b)=>a+b.c,0);
      const sale = user.sale.reduce((a,b)=>a+b.a,0);
      dCost.textContent = "â‚¹"+cost; dSales.textContent = "â‚¹"+sale; dProfit.textContent = "â‚¹"+(sale-cost);
      dProfit.className = 'card-value ' + (sale-cost >= 0 ? 'profit' : 'loss');

      // Activity Feed
      const act = [
        ...user.raw.map(i=>({t:'RAW IN', d:i.d, n:i.n, q:i.q, v:'â‚¹'+i.c})),
        ...user.prod.map(i=>({t:'PROD', d:i.d, n:i.n, q:i.q, v:'Used '+i.rq+' '+i.rn})),
        ...user.sale.map(i=>({t:'SALE', d:i.d, n:i.n, q:i.q, v:'â‚¹'+i.a}))
      ].sort((a,b)=>new Date(b.d)-new Date(a.d)).slice(0, 15);
      activityTable.querySelector("tbody").innerHTML = act.map(a => `<tr><td><b>${a.t}</b></td><td>${a.d}</td><td>${a.n}</td><td>${a.q}</td><td>${a.v}</td></tr>`).join('');
    }


    function logout() {
    localStorage.removeItem('currentSession');
      user=null;
    location.reload(); // Page reload hote hi wapas login screen aa jayegi
}
  </script>
</body>
</html>






